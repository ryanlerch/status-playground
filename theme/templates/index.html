{% extends "base.html" %}
{% block content %}

	{% set outages = categories | categories_dict %}

	<div class="bodycontent">

		<div class="alert-info border-bottom py-5">
			<div class="container section">
			  <div class="row">
				<div class="col-md-12">
					<h2 class="display-4">Fedora Infrastructure Status</h2>
					<p class="lead">
					This is a <strong>manually updated</strong> list of known outages. If you are experiencing issues with a service that is not listed here, please open a ticket in the <a href="https://pagure.io/fedora-infrastructure/issues">Fedora Infrastructure ticket tracker</a>.
					</p>
				</div>
			  </div>
			</div>
		  </div>


		<div class="bg-light pb-5">
		<div class="container">
			<div class="row">
				<div class="col">
				{% if outages['ongoing'] %}
				<div class="card text-white bg-warning my-5 mx-auto">
					<div class="card-header"><h3 class="card-title mb-0">{{outages['ongoing']|count}} Ongoing Outage{{'s' if outages['ongoing']|count > 1 }}</h3></div>
					{% for outage in outages['ongoing'] %}
						<div class="card-body alert-warning border-bottom border-warning">
						<h3>{{outage.title}}</h3>
						<div>{{outage.content}}</div>
						<div class="mb-3">For more information and updates on the progress of this outage, see <a href="{{TICKET_TRACKER_URL}}{{outage.ticket}}">ticket #{{outage.ticket}}</a> </div>
						<h5>Outage Started</h5>
						<div class="mb-2">
							{{outage.date|formatdate}}
						</div>
						<h5>Anticipated End</h5>
						<div>
							{% if outage.metadata.outagefinish %}
								{{outage.metadata.outagefinish|parsedate|formatdate}}
							{% else %}
								unknown
							{% endif %}
						</div>
						</div>
					{% endfor %}
				</div>
				{% else %}
				<div class="card text-white bg-success my-5 mx-auto">
					<div class="card-header"><h3 class="card-title mb-0">All Systems Operational</h3></div>
					<div class="card-body alert-success">
					  <p class="card-text mb-0">There are no known issues or outages with systems in Fedora Infrastructure. If you are experiencing issues with a service, please open a ticket in the <a href="https://pagure.io/fedora-infrastructure/issues">Fedora Infrastructure ticket tracker</a></p>
					</div>
				</div>
				{% endif %}

				<h3 class="card-title card-header border text-muted mb-0">{{outages['planned']|count}} Planned Outage{{'s' if outages['planned']|count > 1 }}</h3>
				<div class="list-group">
				{% for outage in outages['planned'] %}
					<div class="list-group-item">
						<h3>{{outage.title}}</h3>
						<div>{{outage.content}}</div>
						<div class="mb-3">For more information and updates on the progress of this outage, see <a href="{{TICKET_TRACKER_URL}}{{outage.ticket}}">ticket #{{outage.ticket}}</a> </div>
						<h5>Anticipated Start</h5>
						<div class="mb-2">
							{{outage.date|formatdate}}
						</div>
						<h5>Anticipated End</h5>
						<div>
							{% if outage.metadata.outagefinish %}
								{{outage.metadata.outagefinish|parsedate|formatdate}}
							{% else %}
								unknown
							{% endif %}
						</div>
					</div>
				{% endfor %}
				</div>
				<div class="text-right h4 mt-4"><a href="{{ SITEURL }}/resolved/">view resolved outages &raquo;</a></div>	
			</div>
			</div>
		</div>
		</div>
	</div>
{% endblock content %}
